# Транслятор учебного конфигурационного языка в TOML

## 1. Назначение

Инструмент командной строки, который:

- читает конфигурацию из стандартного ввода;
- проверяет синтаксис и семантику;
- вычисляет константы;
- преобразует конфигурацию в словарь Python;
- записывает результат в формат TOML в файл, указанный параметром `-o`.

Разбор реализован через специализированный парсер **Lark**.

---

## 2. Поддерживаемые конструкции языка

Все конструкции языка реализованы и покрыты тестами:

- восьмеричные числа: `0o123`, `0O755`;
- строки: `[[строка]]`;
- словари: `@{ key = value; }`, вложенность произвольная;
- объявления констант: `var имя значение`;
- использование констант: `$имя$`;
- контроль ошибок:
  - синтаксические ошибки;
  - неизвестные константы;
  - повторные объявления констант;
  - дублирование ключей;
  - неверная верхнеуровневая конструкция.

---

## 3. Установка и запуск

### 3.1. Установка зависимостей

```bash
pip install -r requirements.txt
````

### 3.2. Запуск транслятора

Linux/macOS:

```bash
python -m ucfg2toml.cli -o output.toml < input.cfg
```

Windows PowerShell:

```powershell
Get-Content input.cfg | python -m ucfg2toml.cli -o output.toml
```

---

## 4. Запуск тестов

Все автотесты находятся в каталоге `tests/`.

Запуск:

```bash
pytest
```

Тестами покрыто:

* разбор всех конструкций языка;
* вложенные структуры;
* вычисление констант;
* ошибки синтаксиса и семантики;
* работа CLI (успешный запуск и обработка ошибок).

---

## 5. Демонстрационные примеры

Три примера из разных предметных областей находятся в каталоге `examples/`:

* `network.cfg` — сетевая конфигурация;
* `game.cfg` — игровая конфигурация;
* `build.cfg` — параметры сборки.

Проверка примеров:

Linux/macOS:

```bash
python -m ucfg2toml.cli -o out_network.toml < examples/network.cfg
python -m ucfg2toml.cli -o out_game.toml < examples/game.cfg
python -m ucfg2toml.cli -o out_build.toml < examples/build.cfg
```

Windows PowerShell:

```powershell
Get-Content examples/network.cfg | python -m ucfg2toml.cli -o out_network.toml
Get-Content examples/game.cfg    | python -m ucfg2toml.cli -o out_game.toml
Get-Content examples/build.cfg   | python -m ucfg2toml.cli -o out_build.toml
```

---

## 6. Краткий порядок проверки

1. Установить зависимости.
2. Запустить `pytest` — все тесты должны пройти.
3. Выполнить трансляцию трёх файлов из `examples/`.
4. Проверить корректность полученных TOML-файлов.
